include "linear_map.hay"

fn main() {
    
    Map.new::<u64> as [mut map]
    "one" 0 *map Map.insert drop
    "two" 2 *map Map.insert drop
    "three" 3 *map Map.insert drop

    "one" 1 *map Map.insert as [duplicate] {
        &duplicate Opt.is_some if {
            "Replaced value at key `one`: " puts duplicate Opt.unwrap putlnu
        } else {
            "Didn't replace when I should have" putlns
            1 exit 
        }
    }

    "one"   &map Map.get Opt.unwrap @ putlnu
    "two"   &map Map.get Opt.unwrap @ putlnu
    "three" &map Map.get Opt.unwrap @ putlnu
    "four"  &map Map.get as [option] 
    &option Opt.is_none if {
        "Didn't find key `four`" putlns 
    } else {
        "Found an unexpected value for key `four`" putlns
        1 exit 
    }

}
